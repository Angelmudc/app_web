{% extends 'base.html' %}
{% block title %}⚡ Acciones Rápidas – Solicitudes en Proceso{% endblock %}

{% block head %}
<link href="https://cdn.jsdelivr.net/npm/bootstrap-icons@1.11.3/font/bootstrap-icons.css" rel="stylesheet">
<style>
  body {
    background: radial-gradient(circle at top left, #0f172a, #020617 90%);
    font-family: 'Poppins', sans-serif;
    color: #e2e8f0;
  }

  h1 {
    color: #fff;
    font-weight: 600;
  }

  .glass-table {
    background: rgba(255, 255, 255, 0.05);
    border-radius: 12px;
    backdrop-filter: blur(10px);
    -webkit-backdrop-filter: blur(10px);
    box-shadow: 0 10px 25px rgba(0, 0, 0, 0.35);
    overflow: hidden;
  }

  .table thead {
    background: rgba(56, 189, 248, 0.12);
    color: #60a5fa;
  }

  .table tbody tr {
    transition: all 0.25s ease;
    color: #f1f5f9;
  }

  .table tbody tr:hover {
    background: rgba(56, 189, 248, 0.08);
    transform: translateX(3px);
  }

  .btn {
    border-radius: 8px;
    font-weight: 500;
    transition: all 0.25s ease;
  }

  .btn-outline-secondary {
    border-color: #64748b;
    color: #cbd5e1;
  }

  .btn-outline-secondary:hover {
    background: rgba(148, 163, 184, 0.15);
    color: #fff;
  }

  .btn-success {
    background: linear-gradient(135deg, #16a34a, #22c55e);
    border: none;
    color: #fff;
  }

  .btn-success:hover {
    background: linear-gradient(135deg, #22c55e, #4ade80);
    transform: translateY(-1px);
  }

  .btn-danger {
    background: linear-gradient(135deg, #dc2626, #ef4444);
    border: none;
  }

  .btn-danger:hover {
    background: linear-gradient(135deg, #ef4444, #f87171);
    transform: translateY(-1px);
  }

  .btn i {
    font-size: 1rem;
    margin-right: 0.3rem;
  }

  .alert-info {
    background: rgba(59, 130, 246, 0.15);
    border: 1px solid rgba(59, 130, 246, 0.25);
    color: #93c5fd;
    border-radius: 10px;
    padding: 15px 20px;
  }

  .hint {
    color: #94a3b8;
    font-size: 0.9rem;
  }
</style>
{% endblock %}

{% block content %}
<div class="container py-5" style="max-width: 1100px;">
  <!-- Encabezado -->
  <div class="d-flex justify-content-between align-items-center mb-4 flex-wrap gap-3">
    <h1 class="h4 mb-0">⚡ Acciones Rápidas – Solicitudes en Proceso</h1>
    <a href="{{ url_for('admin.listar_clientes') }}" class="btn btn-outline-secondary">
      <i class="bi bi-arrow-left-circle me-1"></i> Volver a Clientes
    </a>
  </div>

  {% if solicitudes %}
  <div class="glass-table">
    <table class="table table-hover align-middle mb-0">
      <thead>
        <tr>
          <th><i class="bi bi-hash"></i> Código</th>
          <th><i class="bi bi-person-badge"></i> Cliente</th>
          <th><i class="bi bi-calendar3"></i> Fecha Solicitud</th>
          <th class="text-end"><i class="bi bi-gear"></i> Acciones</th>
        </tr>
      </thead>
      <tbody>
        {% for s in solicitudes %}
        <tr>
          <td class="fw-semibold text-info">{{ s.codigo_solicitud }}</td>
          <td>{{ s.cliente.nombre_completo }}</td>
          <td>{{ s.fecha_solicitud.strftime('%Y-%m-%d %H:%M') }}</td>
          <td class="text-end">
            <!-- Editar -->
            <a href="{{ url_for('admin.editar_solicitud_admin', cliente_id=s.cliente_id, id=s.id) }}"
               class="btn btn-sm btn-outline-secondary me-1">
              <i class="bi bi-pencil-square"></i> Editar
            </a>

            <!-- Activar -->
            <form method="post"
                  action="{{ url_for('admin.activar_solicitud_directa', id=s.id) }}"
                  class="d-inline">
              <input type="hidden" name="csrf_token" value="{{ csrf_token() }}">
              <button class="btn btn-sm btn-success me-1" title="Marcar como activa">
                <i class="bi bi-check-circle-fill"></i> Activar
              </button>
            </form>

            <!-- Cancelar -->
            <form method="post"
                  action="{{ url_for('admin.cancelar_solicitud_directa', id=s.id) }}"
                  class="d-inline"
                  onsubmit="return confirm('¿Seguro que deseas cancelar esta solicitud?');">
              <input type="hidden" name="csrf_token" value="{{ csrf_token() }}">
              <button class="btn btn-sm btn-danger" title="Cancelar solicitud">
                <i class="bi bi-x-circle-fill"></i> Cancelar
              </button>
            </form>
          </td>
        </tr>
        {% endfor %}
      </tbody>
    </table>
  </div>

  <div class="mt-4 text-center hint">
    <i class="bi bi-info-circle"></i> Usa los botones para activar, editar o cancelar rápidamente solicitudes en proceso.
  </div>

  {% else %}
  <div class="alert alert-info d-flex align-items-center mt-4" role="alert">
    <i class="bi bi-info-circle-fill me-2"></i>
    No hay solicitudes en estado <strong>“proceso”</strong>.
  </div>
  {% endif %}
</div>
{% endblock %}
