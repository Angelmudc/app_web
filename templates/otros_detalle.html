{% extends "ordenes_base.html" %}

{% block content %}
<div class="container mt-4">
  {% if candidato %}
    <h1 class="mb-4 text-center">Detalle del Candidato: {{ candidato["Nombre"] }}</h1>
    {% if mensaje %}
      <div class="alert alert-info">{{ mensaje }}</div>
    {% endif %}
    
    <div class="table-responsive">
      <table class="table table-bordered">
        <thead>
          <tr>
            {% for col in short_headers %}
              <th>{{ col }}</th>
            {% endfor %}
          </tr>
        </thead>
        <tbody>
          <tr>
            {% for col in short_headers %}
              <td>{{ candidato[col] }}</td>
            {% endfor %}
          </tr>
        </tbody>
      </table>
    </div>
    
    <!-- Formulario para editar (los inputs están disabled por defecto) -->
    <form id="detalleForm" method="POST" action="{{ url_for('otros_detalle', identifier=candidato['Nombre'] if candidato['Nombre']|trim != '' else candidato['Cédula']) }}">
      <div class="row">
      {% for idx in range(0, 16) %}
         <div class="col-md-4 mb-3">
            <label class="form-label"><strong>{{ short_headers[idx] }}</strong></label>
            <input type="text" name="col{{ idx+2 }}" class="form-control detail-input" value="{{ candidato[short_headers[idx]] }}" disabled>
         </div>
      {% endfor %}
      </div>
      <div class="text-center">
         <button type="button" id="editarBtn" class="btn btn-primary" onclick="enableEditing()">Editar</button>
         <button type="submit" id="guardarBtn" class="btn btn-success" style="display:none;">Guardar Cambios</button>
      </div>
    </form>
    
    <script>
      function enableEditing() {
         var inputs = document.querySelectorAll('.detail-input');
         inputs.forEach(function(input) {
             input.disabled = false;
         });
         document.getElementById("editarBtn").style.display = "none";
         document.getElementById("guardarBtn").style.display = "inline-block";
      }
    </script>
    
  {% else %}
    <div class="alert alert-danger">Candidato no encontrado.</div>
    <a href="{{ url_for('otros_listar') }}" class="btn btn-secondary">Volver al Listado</a>
  {% endif %}
</div>
{% endblock %}
