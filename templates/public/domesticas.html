{% extends "public/base_public.html" %}

{% block title %}Domésticas disponibles - Doméstica del Cibao A&D{% endblock %}

{% block content %}
<section class="section">
  <div class="container">
    <h1 class="section-title">Domésticas disponibles</h1>
    <p class="section-subtitle">
      Estas candidatas se cargan directamente desde nuestro sistema interno. Cuando actualizamos en la oficina, se actualiza aquí también.
    </p>

    <!-- FILTROS (solo visual por ahora) -->
    <div class="filters">
      <select>
        <option>Ciudad</option>
        <option>Santiago</option>
        <option>Puerto Plata</option>
      </select>
      <select>
        <option>Modalidad</option>
        <option>Con dormida</option>
        <option>Sin dormida</option>
        <option>Por días</option>
      </select>
    </div>

    <div class="grid-3">
      {% for d in domesticas %}
      <div class="card card-domestica">

        <!-- Encabezado: código y estado -->
        <div class="card-domestica-header">
          {% if d.codigo %}
            <span class="badge badge-primario">Código: {{ d.codigo }}</span>
          {% else %}
            <span class="badge badge-secondary">Sin código asignado</span>
          {% endif %}
          <span class="badge badge-success">Disponible</span>
        </div>

        <!-- Avatar centrado (clic para ver grande) -->
        {% if d.foto %}
        <div class="card-domestica-avatar">
          <img
            src="{{ d.foto }}"
            alt="Foto de {{ d.nombre }}"
            onclick="verImagenCompleta(this.src)"
          >
        </div>
        {% endif %}

        <!-- Nombre y edad -->
        <h3 class="card-domestica-nombre">
          {{ d.nombre }}{% if d.edad %}, {{ d.edad }} años{% endif %}
        </h3>

        <!-- Modalidad / ciudad corta -->
        <p class="card-domestica-meta">
          {% if d.modalidad %}
            {{ d.modalidad }}
          {% else %}
            Doméstica disponible
          {% endif %}
          {% if d.ciudad %}
            · {{ d.ciudad }}
          {% endif %}
        </p>

        <!-- Acciones principales -->
        <div class="card-domestica-actions">
          {% if d.pk %}
          <a
            href="{{ url_for('public.detalle_domestica', candidata_pk=d.pk) }}"
            class="btn btn-outline btn-ver-detalle"
          >
            Ver detalles
          </a>
          {% endif %}
          <button
            class="btn btn-secondary btn-oferta"
            data-codigo="{{ d.codigo }}"
            data-nombre="{{ d.nombre }}"
          >
            Ofrecer empleo
          </button>
        </div>
      </div>
      {% endfor %}
    </div>

    {% if domesticas|length == 0 %}
      <p class="info-text">
        Por el momento no hay candidatas para mostrar. Vuelve más tarde o contáctanos por WhatsApp.
      </p>
    {% endif %}

    {% if pagination and pagination.pages > 1 %}
    <nav class="pagination">
      {% if pagination.has_prev %}
        <a href="{{ url_for('public.domesticas', page=pagination.prev_num) }}" class="page-link">
          ← Anterior
        </a>
      {% endif %}
      <span class="page-info">
        Página {{ pagination.page }} de {{ pagination.pages }}
      </span>
      {% if pagination.has_next %}
        <a href="{{ url_for('public.domesticas', page=pagination.next_num) }}" class="page-link">
          Siguiente → 
        </a>
      {% endif %}
    </nav>
    {% endif %}
  </div>
</section>

<section class="section cta-section">
  <div class="container cta-inner">
    <div>
      <h2>¿Te interesa alguna candidata?</h2>
      <p>
        Presiona “Ofrecer empleo” y envíanos tu propuesta. Nosotros gestionamos todo el proceso con la doméstica.
      </p>
    </div>
    <a href="#" class="btn btn-primary" data-solicitar-domestica>
      Ver otras opciones por WhatsApp
    </a>
  </div>
</section>

<!-- MODAL PARA VER LA FOTO EN GRANDE -->
<div id="modalImagen" class="modal-imagen">
  <span class="cerrar-modal" onclick="cerrarImagen()">&times;</span>
  <img class="modal-contenido" id="imgModalGrande" alt="Foto candidata">
</div>

<!-- JS específico para el visor de imagen -->
<script>
  function verImagenCompleta(src) {
    const modal = document.getElementById('modalImagen');
    const img = document.getElementById('imgModalGrande');
    img.src = src;
    modal.style.display = 'block';
  }

  function cerrarImagen() {
    const modal = document.getElementById('modalImagen');
    modal.style.display = 'none';
  }

  // Cerrar si se hace clic fuera de la imagen
  window.addEventListener('click', function (e) {
    const modal = document.getElementById('modalImagen');
    if (e.target === modal) {
      modal.style.display = 'none';
    }
  });
</script>
{% endblock %}
