<!DOCTYPE html>
<html lang="es">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Inscripción de Candidatas</title>
    <link rel="stylesheet" href="/static/styles.css">
</head>
<body>
    <h1>🔍 Inscripción de Candidatas</h1>

    <!-- Formulario de Búsqueda -->
    <form id="buscar-form">
        <input type="text" id="buscar" name="buscar" placeholder="Buscar por cédula o nombre">
        <button type="submit">🔍 Buscar</button>
    </form>

    <hr>

    <!-- Datos de la Candidata -->
    <h2>📋 Datos de la Candidata</h2>
    <p><strong>Código:</strong> <span id="codigo"></span></p>
    <p><strong>Nombre:</strong> <span id="nombre"></span></p>
    <p><strong>Cédula:</strong> <span id="cedula"></span></p>
    <p><strong>Teléfono:</strong> <span id="telefono"></span></p>
    <p><strong>Ciudad:</strong> <span id="ciudad"></span></p>
    <input type="hidden" id="fila_index" name="fila_index">

    <hr>

    <!-- Formulario para completar inscripción -->
    <h2>📝 Completar Inscripción</h2>
    <form id="inscripcion-form">
        <label for="estado">Estado:</label>
        <input type="text" id="estado" name="estado" value="Sí" readonly>

        <label for="monto">Monto:</label>
        <input type="number" id="monto" name="monto" required>

        <label for="fecha">Fecha:</label>
        <input type="date" id="fecha" name="fecha" required>

        <button type="submit">✅ Guardar Inscripción</button>
    </form>

    <script>
        document.getElementById("guardarInscripcion").addEventListener("click", function() {
            let filaIndex = document.getElementById("fila_index").value; // Asegurar que el índice se obtiene bien
            let estado = document.getElementById("estado").value;
            let monto = document.getElementById("monto").value;
            let fecha = document.getElementById("fecha").value;
        
            if (!filaIndex || isNaN(filaIndex) || filaIndex < 1) {
                alert("Error: Índice de fila no válido.");
                return;
            }
        
            let datos = {
                fila_index: filaIndex,
                estado: estado,
                monto: monto,
                fecha: fecha
            };
        
            fetch("/procesar_inscripcion", {
                method: "POST",
                headers: { "Content-Type": "application/json" },
                body: JSON.stringify(datos)
            })
            .then(response => response.json())
            .then(data => {
                if (data.error) {
                    alert("Error: " + data.error);
                } else {
                    alert("✅ Inscripción guardada correctamente.");
                }
            })
            .catch(error => {
                alert("Error en la solicitud: " + error);
            });
        });
        </script>
</body>
</html>