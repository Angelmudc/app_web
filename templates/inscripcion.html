<!DOCTYPE html>
<html lang="es">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>InscripciÃ³n de Candidatas</title>
    <link rel="stylesheet" href="{{ url_for('static', filename='styles.css') }}">
    <script src="{{ url_for('static', filename='script.js') }}" defer></script>
</head>
<body>
    <h1>ğŸ” InscripciÃ³n de Candidatas</h1>
    
    <!-- Formulario de bÃºsqueda -->
    <form id="buscarForm" method="POST" action="{{ url_for('inscripcion') }}">
        <input type="text" name="buscar" placeholder="Buscar por cÃ©dula o nombre" required>
        <button type="submit">ğŸ” Buscar</button>
    </form>

    {% if datos_candidata %}
    <div class="candidata-info">
        <h2>ğŸ“‹ Datos de la Candidata</h2>
        <p><strong>CÃ³digo:</strong> {{ datos_candidata.get('codigo', 'No asignado') }}</p>
        <p><strong>Nombre:</strong> {{ datos_candidata.get('nombre', 'No disponible') }}</p>
        <p><strong>CÃ©dula:</strong> {{ datos_candidata.get('cedula', 'No disponible') }}</p>
        <p><strong>TelÃ©fono:</strong> {{ datos_candidata.get('telefono', 'No disponible') }}</p>
        <p><strong>Ciudad:</strong> {{ datos_candidata.get('ciudad', 'No disponible') }}</p>
    </div>

    <!-- Formulario para inscribir -->
    <h2>ğŸ“ Completar InscripciÃ³n</h2>
    <form id="inscripcionForm" method="POST" action="{{ url_for('procesar_inscripcion') }}">
        <input type="hidden" id="fila_index" name="fila_index" value="{{ datos_candidata.get('fila_index', '') }}">
        
        <label for="estado">Estado:</label>
        <select name="estado" required>
            <option value="SÃ­">SÃ­</option>
            <option value="No">No</option>
        </select>
    
        <label for="monto">Monto (DOP):</label>
        <input type="number" name="monto" required>
    
        <label for="fecha">Fecha:</label>
        <input type="date" name="fecha" value="{{ fecha_hoy }}" required>
    
        <button type="submit">ğŸ’¾ Guardar InscripciÃ³n</button>
    </form>
    
    <script>
    document.addEventListener("DOMContentLoaded", function() {
        let filaIndex = document.getElementById("fila_index").value;
        
        if (!filaIndex) {
            console.error("âŒ Error: Fila index no estÃ¡ definido en el HTML.");
            alert("Error interno: No se encontrÃ³ el Ã­ndice de la fila.");
        }
    });
    </script>
    {% endif %}

    {% if mensaje %}
    <div class="mensaje">
        <p>{{ mensaje }}</p>
    </div>
    {% endif %}
</body>
</html>